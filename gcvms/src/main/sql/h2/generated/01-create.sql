--
-- (c) Copyright 2005-2013 JAXIO, http://www.jaxio.com
-- Source code generated by Celerio, a Jaxio product
-- Want to purchase Celerio ? email us at info@jaxio.com
-- Follow us on twitter: @springfuse
-- Documentation: http://www.jaxio.com/documentation/celerio/
-- Template pack-backend-jpa:src/main/sql/h2/01-create.p.vm.sql
--

DROP ALL objects;


-- =================================
-- TABLE DAILY_TRIP 
-- =================================

CREATE TABLE DAILY_TRIP (
	ID INTEGER(32) not null,
	TRIP_DATE DATE,
	VEHICLE_ID INTEGER(32) not null,
	ROUTE_ID INTEGER(32) not null,
	TRIP_TIME TIMESTAMP,
	SUPERVISOR_ID INTEGER(32));

CREATE UNIQUE INDEX IF NOT EXISTS SYS_IDX_SYS_PK_10171_10174 ON DAILY_TRIP (ID);
ALTER TABLE DAILY_TRIP ALTER COLUMN ID IDENTITY;


-- =================================
-- TABLE DEPT 
-- =================================

CREATE TABLE DEPT (
	ID INTEGER(32) not null,
	NAME VARCHAR(20) not null);

CREATE UNIQUE INDEX IF NOT EXISTS SYS_IDX_SYS_PK_10143_10145 ON DEPT (ID);
ALTER TABLE DEPT ALTER COLUMN ID IDENTITY;


-- =================================
-- TABLE EMPLOYEE 
-- =================================

CREATE TABLE EMPLOYEE (
	EMPID INTEGER(32) not null,
	FNAME VARCHAR(20) not null,
	LNAME VARCHAR(20) not null,
	PWD VARCHAR(20) not null,
	DEPT_ID INTEGER(32) not null,
	MUN_ID INTEGER(32) not null,
	SUPERVISOR_ID INTEGER(32),
	DESIGNATION VARCHAR(20) not null);

CREATE UNIQUE INDEX IF NOT EXISTS SYS_IDX_SYS_PK_10151_10158 ON EMPLOYEE (EMPID);
ALTER TABLE EMPLOYEE ALTER COLUMN EMPID IDENTITY;


-- =================================
-- TABLE MUNICIPALITY 
-- =================================

CREATE TABLE MUNICIPALITY (
	ID INTEGER(32) not null,
	NAME VARCHAR(30) not null);

CREATE UNIQUE INDEX IF NOT EXISTS SYS_IDX_SYS_PK_10147_10149 ON MUNICIPALITY (ID);
ALTER TABLE MUNICIPALITY ALTER COLUMN ID IDENTITY;


-- =================================
-- TABLE ROUTE 
-- =================================

CREATE TABLE ROUTE (
	ID INTEGER(32) not null,
	NAME VARCHAR(30),
	DISTANCE DECIMAL(10,3) not null,
	START_LOC VARCHAR(25),
	END_LOC VARCHAR(25),
	CREATED_BY INTEGER(32),
	CREATED_DATE DATE);

CREATE UNIQUE INDEX IF NOT EXISTS SYS_IDX_SYS_PK_10123_10126 ON ROUTE (ID);
CREATE UNIQUE INDEX IF NOT EXISTS SYS_IDX_SYS_CT_10124_10127 ON ROUTE (NAME);
ALTER TABLE ROUTE ALTER COLUMN ID IDENTITY;


-- =================================
-- TABLE TRIP_SCHEDULE 
-- =================================

CREATE TABLE TRIP_SCHEDULE (
	ID INTEGER(32) not null,
	VEHICLE_ID INTEGER(32) not null,
	ROUTE_ID INTEGER(32) not null,
	TRIP_CNT INTEGER(32) not null,
	START_DT DATE,
	END_DT DATE,
	CREATED_BY INTEGER(32),
	CREATED_DATE DATE);

CREATE UNIQUE INDEX IF NOT EXISTS SYS_IDX_SYS_PK_10131_10135 ON TRIP_SCHEDULE (ID);
ALTER TABLE TRIP_SCHEDULE ALTER COLUMN ID IDENTITY;


-- =================================
-- TABLE VEHICLE 
-- =================================

CREATE TABLE VEHICLE (
	ID INTEGER(32) not null,
	REG_NO VARCHAR(20),
	TYP_ID INTEGER(32) not null,
	MILEAGE INTEGER(32),
	CREATED_BY INTEGER(32),
	CREATED_DATE DATE);

CREATE UNIQUE INDEX IF NOT EXISTS SYS_IDX_SYS_PK_10114_10118 ON VEHICLE (ID);
CREATE UNIQUE INDEX IF NOT EXISTS SYS_IDX_SYS_CT_10115_10119 ON VEHICLE (REG_NO);
ALTER TABLE VEHICLE ALTER COLUMN ID IDENTITY;


-- =================================
-- TABLE VEHICLE_TYP 
-- =================================

CREATE TABLE VEHICLE_TYP (
	ID INTEGER(32) not null,
	TYP_NAME VARCHAR(20) not null,
	CAPACITY DECIMAL(10,3) not null,
	CAP_UNIT VARCHAR(10),
	CREATED_BY INTEGER(32),
	CREATED_DATE DATE);

CREATE UNIQUE INDEX IF NOT EXISTS SYS_IDX_SYS_PK_10097_10100 ON VEHICLE_TYP (ID);
ALTER TABLE VEHICLE_TYP ALTER COLUMN ID IDENTITY;

ALTER TABLE DAILY_TRIP ADD CONSTRAINT DAILY_TRIP_FK1 FOREIGN KEY (VEHICLE_ID) REFERENCES VEHICLE (ID);
ALTER TABLE DAILY_TRIP ADD CONSTRAINT DAILY_TRIP_FK2 FOREIGN KEY (ROUTE_ID) REFERENCES ROUTE (ID);
ALTER TABLE DAILY_TRIP ADD CONSTRAINT DAILY_TRIP_FK3 FOREIGN KEY (SUPERVISOR_ID) REFERENCES EMPLOYEE (EMPID);
ALTER TABLE EMPLOYEE ADD CONSTRAINT EMPLOYEE_FK2 FOREIGN KEY (MUN_ID) REFERENCES MUNICIPALITY (ID);
ALTER TABLE EMPLOYEE ADD CONSTRAINT EMPLOYEE_FK3 FOREIGN KEY (SUPERVISOR_ID) REFERENCES EMPLOYEE (EMPID);
ALTER TABLE EMPLOYEE ADD CONSTRAINT EMPLOYEE_FK1 FOREIGN KEY (DEPT_ID) REFERENCES DEPT (ID);
ALTER TABLE TRIP_SCHEDULE ADD CONSTRAINT TRIP_SCHEDULE_FK2 FOREIGN KEY (ROUTE_ID) REFERENCES ROUTE (ID);
ALTER TABLE TRIP_SCHEDULE ADD CONSTRAINT TRIP_SCHEDULE_FK1 FOREIGN KEY (VEHICLE_ID) REFERENCES VEHICLE (ID);
ALTER TABLE VEHICLE ADD CONSTRAINT SYS_FK_10117 FOREIGN KEY (TYP_ID) REFERENCES VEHICLE_TYP (ID);